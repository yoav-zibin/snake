angular.module("myApp",["ngTouch","ui.bootstrap"]).run(["$translate","$log","realTimeService","randomService",function(a,b,c,d){"use strict";function e(c){function e(a){O=a.yourPlayerIndex,N=a.playersInfo,P=a.matchController,L=!0,M=1===N.length,G=0,D=[],F=[];for(var b=0;b<N.length;b++)D[b]=t(b),F[b]=0;E=D[O],u(),H="right",J=(new Date).getTime(),r()}function n(a){var b=a.fromPlayerIndex,c=a.message,d=angular.fromJson(c);for(D[b]=d.a,F[b]=d.s;G<d.f;)u()}function o(a){F=a,L=!1,s()}function p(a){if(!M&&L){var b=angular.toJson({f:G,s:F[O],a:E});a?P.sendReliableMessage(b):P.sendUnreliableMessage(b)}}function q(){L&&(L=!1,P.endMatch(F))}function r(){s();var a=Math.max(50,l-10*Math.floor(G/2));K=setInterval(v,a)}function s(){clearInterval(K)}function t(a){for(var b=5,c=[],d=b-1;d>=0;d--)c.push({x:d,y:a-Math.floor(N.length/2)+f/h/2});return c}function u(){I={x:d.randomFromTo(2*G,0,k),y:d.randomFromTo(2*G+1,0,j)},G++,r()}function v(){if(L){var b=Math.floor(((new Date).getTime()-J)/1e3);if(3>b){R=[],w();var c=3-b,d=m[O];Q.fillStyle=d,Q.font="80px sans-serif",Q.fillText(""+c,f/2,g/2),Q.font="20px sans-serif";var e=a("YOUR_SNAKE_COLOR_IS",{color:a(d.toUpperCase())});return void Q.fillText(e,f/4-30,g/4-30)}A();var h=E[0].x,i=E[0].y;if("right"===H?h++:"left"===H?h--:"up"===H?i--:"down"===H&&i++,-1===h||h===k||-1===i||i===j||z(h,i,E))return void q();var l,n=!1;h===I.x&&i===I.y?(n=!0,l={x:h,y:i},F[O]++,u()):(l=E.pop(),l.x=h,l.y=i),E.unshift(l),p(n),w()}}function w(){Q.fillStyle="white",Q.fillRect(0,0,f,g),Q.strokeStyle="black",Q.strokeRect(0,0,f,g);var b;for(b=0;b<D.length;b++)b!==O&&x(D[b],b);for(x(E,O),y(I.x,I.y,"green"),b=0;b<F.length;b++){Q.font="12px sans-serif";var c=m[b];Q.fillStyle=c;var d=a("COLOR_SCORE_IS",{color:a(c.toUpperCase()),score:""+F[b]});Q.fillText(d,5+b*f/N.length,g-5)}}function x(a,b){for(var c=0;c<a.length;c++){var d=a[c];y(d.x,d.y,m[b])}}function y(a,b,c){Q.fillStyle=c,Q.fillRect(a*h,b*i,h,i),Q.strokeStyle="white",Q.strokeRect(a*h,b*i,h,i)}function z(a,b,c){for(var d=0;d<c.length;d++)if(c[d].x===a&&c[d].y===b)return!0;return!1}function A(){var a=R.shift();a&&("left"===a&&"right"!==H?H="left":"up"===a&&"down"!==H?H="up":"right"===a&&"left"!==H?H="right":"down"===a&&"up"!==H&&(H="down"))}function B(a){R.length>0&&R[R.length-1]===a||R.push(a)}function C(a){a.preventDefault();var b=a.targetTouches[0];if(b){if(null===S)return S=b.pageX,void(T=b.pageY);var c=b.pageX-S,d=b.pageY-T,e=null,f=Math.abs(c),g=Math.abs(d);(f>=20||g>=20)&&(S=b.pageX,T=b.pageY,e=f>g?0>c?"left":"right":0>d?"up":"down",B(e))}}b.info("createCanvasController for canvas.id="+c.id);var D,E,F,G,H,I,J,K,L=!1,M=!1,N=null,O=null,P=null,Q=c.getContext("2d"),R=[];document.addEventListener("keydown",function(a){var b=a.which,c=37===b?"left":38===b?"up":39===b?"right":40===b?"down":null;null!==c&&B(c)},!1);var S=null,T=null;return c.addEventListener("touchstart",function(a){S=null,T=null,C(a)},!1),c.addEventListener("touchmove",function(a){C(a)},!1),c.addEventListener("touchend",function(a){C(a)},!1),{gotStartMatch:e,gotMessage:n,gotEndMatch:o}}var f=300,g=300,h=10,i=10,j=f/h,k=g/i,l=120,m=["blue","red","brown","purple","pink","yellow","orange","silver"];c.init({createCanvasController:e,canvasWidth:f,canvasHeight:g})}]);
//# sourceMappingURL=index.min.js.map