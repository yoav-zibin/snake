angular.module("myApp",["ngTouch","ui.bootstrap"]).run(["$translate","$log","realTimeService","randomService","$rootScope",function(a,b,c,d,e){"use strict";function f(c){function e(a){O=a.yourPlayerIndex,N=a.playersInfo,P=a.matchController,n=!0,o=1===N.length,I=0,F=[],H=[];for(var b=0;b<N.length;b++)F[b]=v(b),H[b]=0;G=F[O],w(),J="right",L=(new Date).getTime(),t()}function f(a){var b=a.fromPlayerIndex,c=a.message,d=angular.fromJson(c);for(F[b]=d.a,H[b]=d.s;I<d.f;)w()}function q(a){H=a,n=!1,u()}function r(a){if(!o&&n){var b=angular.toJson({f:I,s:H[O],a:G});a?P.sendReliableMessage(b):P.sendUnreliableMessage(b)}}function s(){n&&(n=!1,P.endMatch(H))}function t(){u();var a=Math.max(50,m-10*Math.floor(I/2));M=setInterval(x,a)}function u(){clearInterval(M)}function v(a){for(var b=5,c=[],d=b-1;d>=0;d--)c.push({x:d,y:a-Math.floor(N.length/2)+g/i/2});return c}function w(){K={x:d.randomFromTo(2*I,0,l),y:d.randomFromTo(2*I+1,0,k)},I++,t()}function x(){if(n){var b=Math.floor(((new Date).getTime()-L)/1e3);if(3>b){R=[],y();var c=3-b,d=p[O];Q.fillStyle=d,Q.font="80px sans-serif",Q.fillText(""+c,g/2,h/2),Q.font="20px sans-serif";var e=a("YOUR_SNAKE_COLOR_IS",{color:a(d.toUpperCase())});return void Q.fillText(e,g/4-30,h/4-30)}C();var f=G[0].x,i=G[0].y;if("right"===J?f++:"left"===J?f--:"up"===J?i--:"down"===J&&i++,-1===f||f===l||-1===i||i===k||B(f,i,G))return void s();var j,m=!1;f===K.x&&i===K.y?(m=!0,j={x:f,y:i},H[O]++,w()):(j=G.pop(),j.x=f,j.y=i),G.unshift(j),r(m),y()}}function y(){Q.fillStyle="white",Q.fillRect(0,0,g,h),Q.strokeStyle="black",Q.strokeRect(0,0,g,h);var b;for(b=0;b<F.length;b++)b!==O&&z(F[b],b);for(z(G,O),A(K.x,K.y,"green"),b=0;b<H.length;b++){Q.font="12px sans-serif";var c=p[b];Q.fillStyle=c;var d=a("COLOR_SCORE_IS",{color:a(c.toUpperCase()),score:""+H[b]});Q.fillText(d,5+b*g/N.length,h-5)}}function z(a,b){for(var c=0;c<a.length;c++){var d=a[c];A(d.x,d.y,p[b])}}function A(a,b,c){Q.fillStyle=c,Q.fillRect(a*i,b*j,i,j),Q.strokeStyle="white",Q.strokeRect(a*i,b*j,i,j)}function B(a,b,c){for(var d=0;d<c.length;d++)if(c[d].x===a&&c[d].y===b)return!0;return!1}function C(){var a=R.shift();a&&("left"===a&&"right"!==J?J="left":"up"===a&&"down"!==J?J="up":"right"===a&&"left"!==J?J="right":"down"===a&&"up"!==J&&(J="down"))}function D(a){R.length>0&&R[R.length-1]===a||R.push(a)}function E(a){a.preventDefault();var b=a.targetTouches[0];if(b){if(null===S)return S=b.pageX,void(T=b.pageY);var c=b.pageX-S,d=b.pageY-T,e=null,f=Math.abs(c),g=Math.abs(d);(f>=20||g>=20)&&(S=b.pageX,T=b.pageY,e=f>g?0>c?"left":"right":0>d?"up":"down",D(e))}}b.info("createCanvasController for canvas.id="+c.id);var F,G,H,I,J,K,L,M,N=null,O=null,P=null,Q=c.getContext("2d"),R=[];document.addEventListener("keydown",function(a){var b=a.which,c=37===b?"left":38===b?"up":39===b?"right":40===b?"down":null;null!==c&&D(c)},!1);var S=null,T=null;return c.addEventListener("touchstart",function(a){S=null,T=null,E(a)},!1),c.addEventListener("touchmove",function(a){E(a)},!1),c.addEventListener("touchend",function(a){E(a)},!1),{gotStartMatch:e,gotMessage:f,gotEndMatch:q}}var g=300,h=300,i=10,j=10,k=g/i,l=h/j,m=120,n=!1,o=!1,p=["blue","red","brown","purple","pink","yellow","orange","silver"];e.pause=function(){return o&&(n=!1),!0},e.unPause=function(){return o&&(n=!0),!1},c.init({createCanvasController:f,canvasWidth:g,canvasHeight:h})}]);
//# sourceMappingURL=index.min.js.map